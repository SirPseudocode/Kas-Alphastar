<style>
  :root{
    --bg:#0a0a0a;--card:#111;--muted:#888;--text:#f3f3f3;--accent:#ff2d55;--accent-2:#ffd60a;--ok:#1db954;--warn:#ffb020;
    --ring: rgba(255,255,255,.12);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;background:radial-gradient(1200px 600px at 20% -10%,rgba(255,214,10,.08),transparent 60%),
               radial-gradient(1200px 600px at 80% 110%,rgba(255,45,85,.08),transparent 60%),var(--bg);
    color:var(--text);font:16px/1.5 ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
    -webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;
  }
  header{
    padding:24px 16px 8px; display:flex; align-items:center; justify-content:center; gap:12px; flex-wrap:wrap;
  }
  header img.logo{height:44px; width:auto; border-radius:12px; box-shadow:0 4px 18px rgba(0,0,0,.35)}
  header .brand{font-weight:800; letter-spacing:.08em; font-size:20px}
  .banner{max-width:100%; display:block; margin: 8px auto 0; width:min(1100px,100%);}
  main{max-width:880px;margin:20px auto;padding:0 16px 80px}
  .card{
    background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));
    border:1px solid var(--ring); border-radius:20px; box-shadow:0 10px 30px rgba(0,0,0,.25);
    padding:20px; backdrop-filter:saturate(120%) blur(4px);
  }
  .search-wrap{display:flex; gap:10px; align-items:stretch; margin:16px 0 8px}
  .input{
    flex:1; padding:14px 16px; border-radius:14px; border:1px solid var(--ring); background:#0f0f10;color:var(--text);
    outline:none; box-shadow:inset 0 0 0 1px transparent; transition:.2s box-shadow,.2s border-color;
  }
  .input:focus{border-color:rgba(255,255,255,.28); box-shadow:0 0 0 4px rgba(255,255,255,.08)}
  .btn{
    padding:12px 16px; border:1px solid var(--ring); background:linear-gradient(90deg,var(--accent),#ff3b30);
    color:#fff; border-radius:14px; cursor:pointer; font-weight:700; letter-spacing:.02em;
    box-shadow:0 8px 20px rgba(255,45,85,.3); transition:transform .06s ease, box-shadow .15s;
  }
  .btn:active{transform:translateY(1px)}
  /* tambahan focus keyboard */
  .btn:focus-visible{
    outline: none;
    box-shadow:0 0 0 3px rgba(255,214,10,.35), 0 8px 20px rgba(255,45,85,.3);
  }
  .hint{color:var(--muted); margin:0 2px 12px}
  .total{
      margin: 14px 0; padding:16px 18px; border-radius:18px;
      background: radial-gradient(300px 120px at 100% 0,var(--accent-2),transparent 60%),
                  radial-gradient(300px 120px at 0 100%,rgba(255,45,85,.45),transparent 60%),
                  #141414;
      border:1px solid var(--ring);
      display:flex; align-items:center; justify-content:space-between; gap:8px; flex-wrap:wrap;
    }
    .total h2{margin:0;font-size:18px;font-weight:600; letter-spacing:.02em}
    .total .value{font:800 28px/1 ui-sans-serif,system-ui; letter-spacing:.01em}
    .badge{display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px; font-weight:700; letter-spacing:.02em}
    .ok{background:rgba(29,185,84,.15); border:1px solid rgba(29,185,84,.35)}
    .warn{background:rgba(255,176,32,.14); border:1px solid rgba(255,176,32,.35)}
    .empty{background:rgba(255,255,255,.06); border:1px dashed var(--ring); padding:18px; border-radius:14px; color:var(--muted)}
    table{width:100%; border-collapse:collapse; margin-top:8px}
    th,td{padding:12px 10px; border-bottom:1px solid rgba(255,255,255,.06)}
    th{color:#cfcfcf; text-align:left; font-weight:700; letter-spacing:.02em}
    td:last-child, th:last-child{text-align:right}
    .chips{display:flex; gap:8px; flex-wrap:wrap; margin-top:8px}
    .chip{
      padding:8px 12px;
      background: rgba(255,255,255,.12);   /* lebih terang dari #121212 */
      color: #fff;                          /* teks putih biar kontras */
      border: 1px solid rgba(255,255,255,.28);
      border-radius: 999px;
      cursor: pointer;
      font-weight: 600;
      letter-spacing: .01em;
      transition: background .15s, border-color .15s, transform .05s, box-shadow .15s;
    }
    .chip:hover{
      background: rgba(255,255,255,.18);
      border-color: rgba(255,255,255,.45);
    }
    .chip:focus-visible{
      outline: none;
      box-shadow: 0 0 0 3px rgba(255,214,10,.35); /* ring kuning (selaras accent-2) */
    }
    .chip:active{ transform: translateY(1px) }
    footer{max-width:880px;margin:0 auto;padding:24px 16px;color:#a3a3a3;font-size:13px}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
  </style>
</head>
<body>
  <header>
    <img class="logo" src="assets/Alphastar.jpg" alt="Logo AlphaStar" loading="lazy">
    <div class="brand">KAS ALPHASTAR</div>
  </header>

  <main>
    <section class="card" aria-labelledby="judul-form">
      <h1 id="judul-form" class="sr-only">Pencarian Tagihan</h1>
      <form id="searchForm" class="search-wrap" role="search" aria-label="Cari nama">
        <label class="sr-only" for="name">Nama</label>
        <input class="input" id="name" name="name" placeholder="Masukkan nama lalu Enter…" autocomplete="off" required>
        <button class="btn" type="submit" aria-label="Cari">Cari</button>
      </form>
      <p class="hint">Contoh: <em>zakir</em>, <em>Affam</em>, <em>IKI</em></p>
      <div id="result" aria-live="polite"></div>
    </section>
  </main>
  <footer>
    © <span id="y"></span> AlphaStar. Dibuat ringan, cepat, dan ramah mesin pencari.
  </footer>
<script>
const CONFIG = {
  // URL Web App Google Apps Script kamu:
  SCRIPT_URL: "https://script.google.com/macros/s/AKfycbx32o32N8-41jnjIxEPu_G64tcnRjHrP8dqIQdtMgSrLPv50j5qwMBuctgwXFibYJttYw/exec"
};

// Helper
const el = sel => document.querySelector(sel);
const fmtRp = n => (n||0).toLocaleString('id-ID',{style:'currency',currency:'IDR',maximumFractionDigits:0});

function render(data, q) {
  const box = el('#result');
  if (!data.ok) {
    box.innerHTML = '<div class="empty">Terjadi kesalahan: '+(data.error||'Tidak diketahui')+'</div>';
    return;
  }
  const hasBills = data.hasActiveBills;
  const total = fmtRp(data.total);
  const items = data.items||[];
  const suggest = data.suggest||[];
  const foundInMaster = data.foundInMaster;

  const badge = hasBills
    ? '<span class="badge warn">Ada tagihan aktif</span>'
    : '<span class="badge ok">Tidak ada tagihan</span>';

  let html = `
    <div class="total">
      <h2>Hasil untuk: <strong>${escapeHtml(q)}</strong></h2>
      <div class="value">${total}</div>
      ${badge}
    </div>
  `;

  if (!foundInMaster && suggest.length) {
    html += `<div class="chips"><div class="hint">Maksud Anda:</div>${
    suggest.map(s=>`<button type="button" class="chip" data-suggest="${s}">${s}</button>`).join('')
    }</div>`;
  }

  if (items.length) {
    html += `
      <table aria-label="Rincian tagihan">
        <thead><tr><th>Item</th><th>Nominal</th></tr></thead>
        <tbody>
          ${items.map(it=>`<tr><td>${escapeHtml(String(it.item||''))}</td><td>${fmtRp(it.amount)}</td></tr>`).join('')}
        </tbody>
      </table>
    `;
  } else {
    html += '<div class="empty">Tidak ada rincian tagihan untuk nama tersebut.</div>';
  }

  box.innerHTML = html;
  // Wire suggestion chips
  box.querySelectorAll('[data-suggest]').forEach(btn=>{
    btn.addEventListener('click',()=>{
      el('#name').value = btn.getAttribute('data-suggest');
      doSearch(btn.getAttribute('data-suggest'));
    });
  });
}

function escapeHtml(str){
  return String(str).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
}

async function doSearch(q){
  const resultBox = el('#result');
  resultBox.innerHTML = '<div class="empty">Memuat…</div>';
  // Update URL for shareability
  const url = new URL(window.location);
  url.searchParams.set('name', q);
  history.replaceState(null, '', url);

  try{
    const res = await fetch(CONFIG.SCRIPT_URL + '?name=' + encodeURIComponent(q), {
      method:'GET',
      headers:{'Accept': 'application/json'}
    });
    const data = await res.json();
    render(data, q);
  }catch(err){
    resultBox.innerHTML = '<div class="empty">Gagal mengambil data. Pastikan URL Apps Script benar dan di-deploy publik.</div>';
    console.error(err);
  }
}

el('#searchForm').addEventListener('submit', e=>{
  e.preventDefault();
  const q = el('#name').value.trim();
  if(q) doSearch(q);
});

// Deep-link via ?name=
const params = new URLSearchParams(location.search);
const initial = params.get('name');
if (initial){
  el('#name').value = initial;
  doSearch(initial);
}
el('#y').textContent = new Date().getFullYear();
</script>
</body>
</html>
